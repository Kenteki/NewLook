@page "/logout"
@using NewLook.Services
@inject CustomAuthenticationStateProvider AuthStateProvider
@inject NavigationManager Navigation
@inject ILogger<Logout> Logger

<PageTitle>Logging out...</PageTitle>

<div class="d-flex justify-content-center align-items-center vh-100">
    <div class="text-center">
        <div class="spinner-border spinner-border-lg text-primary mb-3" role="status">
            <span class="visually-hidden">Logging out...</span>
        </div>
        <h4>Logging out...</h4>
        <p class="text-muted">Please wait while we log you out.</p>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        try
        {
            Logger.LogInformation("Logout page loaded - clearing authentication state");
            await AuthStateProvider.UpdateAuthenticationState(null);
            Logger.LogInformation("User logged out successfully");

            // Small delay to show the logout message
            await Task.Delay(500);
            Navigation.NavigateTo("/", true);
        }
        catch (Exception ex)
        {
            Logger.LogError(ex, "Error during logout");
            Navigation.NavigateTo("/", true);
        }
    }
}
