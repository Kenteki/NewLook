@page "/verify-email"
@inject ApiService Api
@inject NavigationManager Navigation

<PageTitle>Verify Email - NewLook</PageTitle>

<div class="container">
    <div class="row justify-content-center mt-5">
        <div class="col-md-6 text-center">
            @if (isVerifying)
            {
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
                <p class="mt-3">Verifying your email...</p>
            }
            else if (isSuccess)
            {
                <div class="alert alert-success">
                    <h4>Email Verified!</h4>
                    <p>Your email has been successfully verified.</p>
                    <a href="/login" class="btn btn-primary mt-3">Go to Login</a>
                </div>
            }
            else
            {
                <div class="alert alert-danger">
                    <h4>Verification Failed</h4>
                    <p>@errorMessage</p>
                    <a href="/" class="btn btn-secondary mt-3">Go Home</a>
                </div>
            }
        </div>
    </div>
</div>

@code {
    private bool isVerifying = true;
    private bool isSuccess = false;
    private string errorMessage = "";

    protected override async Task OnInitializedAsync()
    {
        var uri = new Uri(Navigation.Uri);
        var query = System.Web.HttpUtility.ParseQueryString(uri.Query);
        var token = query["token"];

        if (string.IsNullOrEmpty(token))
        {
            isVerifying = false;
            errorMessage = "Invalid verification link";
            return;
        }

        // Call API to verify
        // You'll need to add this method to ApiService
        // For now, just show success
        await Task.Delay(1000);
        isVerifying = false;
        isSuccess = true;
    }
}